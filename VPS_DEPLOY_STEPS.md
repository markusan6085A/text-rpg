# üöÄ –®–≤–∏–¥–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ VPS

## –ö—Ä–æ–∫ 1: –ü–ö (Cursor) - –ó–∞–ø—É—à–∏—Ç–∏ –∑–º—ñ–Ω–∏ –≤ GitHub

–£ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ Cursor –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ—î–∫—Ç—É (—Ç–∞–º –¥–µ package.json, server/, src/):

```bash
git status
git add -A
git commit -m "fix: build and deploy"
git push
```

**–Ø–∫—â–æ `git commit` —Å–∫–∞–∂–µ "nothing to commit"** ‚Äî –∑–Ω–∞—á–∏—Ç—å –Ω—ñ—á–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ –Ω–µ –∑–±–µ—Ä—ñ–≥/–Ω–µ –∑–º—ñ–Ω–∏–≤ —É —Ü—ñ–π –ø–∞–ø—Ü—ñ.

---

## –ö—Ä–æ–∫ 2: VPS - –ó–∞–±—Ä–∞—Ç–∏ –∑–º—ñ–Ω–∏ –∑ GitHub

–ó–∞—Ö–æ–¥–∏—à –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

```bash
ssh root@116.203.243.128
```

–î–∞–ª—ñ:

```bash
cd /opt/text-rpg
git pull
```

**–ü–µ—Ä–µ–≤—ñ—Ä —â–æ –ø—ñ–¥—Ç—è–≥–Ω—É–ª–æ:**

```bash
git log -1 --oneline
```

---

## –ö—Ä–æ–∫ 3: VPS - –ü–µ—Ä–µ–∑—ñ–±—Ä–∞—Ç–∏ backend (–ø—ñ—Å–ª—è pull)

```bash
cd /opt/text-rpg/server
npm ci
npm run build
```

**–Ø–∫—â–æ `npm run build` –ø—Ä–æ–π—à–æ–≤** ‚Äî –¥–∞–ª—ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ.

---

## –ö—Ä–æ–∫ 4: VPS - –ó–∞–ø—É—Å–∫ (—Ç–∏–º—á–∞—Å–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞)

```bash
cd /opt/text-rpg/server
node dist/index.js
```

**–í —ñ–Ω—à–æ–º—É –≤—ñ–∫–Ω—ñ (–∞–±–æ Ctrl+C —ñ –¥–∞–ª—ñ) –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞:**

```bash
curl -i http://127.0.0.1:3000/health
```

**–Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î** ‚Äî –∑—É–ø–∏–Ω–∏ `Ctrl+C` —ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ —á–µ—Ä–µ–∑ PM2.

---

## –ö—Ä–æ–∫ 5: VPS - –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2 (–ø–æ—Å—Ç—ñ–π–Ω–æ)

```bash
cd /opt/text-rpg/server

# –ó—É–ø–∏–Ω–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π –ø—Ä–æ—Ü–µ—Å (—è–∫—â–æ —ñ—Å–Ω—É—î)
pm2 delete text-rpg-api 2>/dev/null || true

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤–∏–π
pm2 start dist/index.js --name text-rpg-api
pm2 save
pm2 startup
```

**–ö–æ–º–∞–Ω–¥—É, —è–∫—É –ø–æ–∫–∞–∂–µ `pm2 startup`, –≤–∏–∫–æ–Ω–∞–π 1 —Ä–∞–∑ (–∑–∞–∑–≤–∏—á–∞–π –∑ sudo).**

**–°—Ç–∞—Ç—É—Å:**

```bash
pm2 status
pm2 logs text-rpg-api --lines 80
```

---

## –®–≤–∏–¥–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ—Å–ª—è –¥–µ–ø–ª–æ—é

```bash
# 1. –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤
docker ps

# 2. –°—Ç–∞—Ç—É—Å PM2
pm2 status

# 3. Health check
curl -i http://127.0.0.1:3000/health

# 4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ nginx (—è–∫—â–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ)
curl -i http://127.0.0.1/health
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: git pull –Ω–µ –ø—Ä–∞—Ü—é—î

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —î –∑–º—ñ–Ω–∏
git status

# –Ø–∫—â–æ —î –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏
git stash
git pull
git stash pop
```

### –ü—Ä–æ–±–ª–µ–º–∞: npm run build –Ω–µ –ø—Ä–∞—Ü—é—î

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏
npm run build 2>&1 | tee build.log

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ .env
cat .env

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Prisma
npm run prisma:generate
```

### –ü—Ä–æ–±–ª–µ–º–∞: —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ PM2
pm2 logs text-rpg-api --lines 100

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ .env
cat /opt/text-rpg/server/.env | grep -E "DATABASE_URL|JWT_SECRET|PORT"

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î
docker ps | grep db
```

### –ü—Ä–æ–±–ª–µ–º–∞: health check –Ω–µ –ø—Ä–∞—Ü—é—î

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —Å–ª—É—Ö–∞—î –ø–æ—Ä—Ç
ss -lntp | grep :3000

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø—Ä–∞—Ü—é—î —Å–µ—Ä–≤–µ—Ä
pm2 status

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
pm2 logs text-rpg-api --lines 50
```
