# Система відображення екіпірування на моделі героя

Ця система дозволяє відображати екіпіровані предмети (броня, зброя) на моделі персонажа.

## ✅ Що вже готово

- ✅ Файли екіпірування скопійовані в `public/equipment/`
- ✅ Система відображення налаштована та працює
- ✅ Структура коду модульна та легко розширюється
- ✅ Додано скрипт для перегляду файлів (`scripts/list-equipment-files.ps1`)

## Структура

```
src/utils/equipment/
├── raceMapping.ts              # Маппінг рас до числових ID
├── itemEquipmentMapping.ts     # Маппінг предметів до ID файлів
├── getEquipmentImagePath.ts    # Утиліта для отримання шляхів
└── index.ts                    # Експорт всіх утиліт
```

## Як це працює

1. **Маппінг рас** (`raceMapping.ts`):
   - Конвертує назви рас ("Human", "Elf") в числові ID (0, 10, 18...)
   - Відповідає структурі папок: `equipment/{view}/{raceId}-{gender}/`

2. **Маппінг предметів** (`itemEquipmentMapping.ts`):
   - Зв'язує ID предметів з `itemsDB` з числовими ID файлів екіпірування
   - Наприклад: `ng_helmet_leather` → `0.png`

3. **Отримання шляху** (`getEquipmentImagePath.ts`):
   - Формує повний шлях до зображення екіпірування
   - Формат: `/equipment/{view}/{raceId}-{gender}/{fileId}.png`

## Налаштування

### 1. Перегляд доступних файлів

Використовуйте скрипт для перегляду файлів:

```powershell
# Перегляд файлів для Human Male
.\scripts\list-equipment-files.ps1

# Або для іншої раси/статі
.\scripts\list-equipment-files.ps1 -Race 10 -Gender female -View front
```

Або вручну відкрийте папку: `public/equipment/front/0-male/`

### 2. Налаштування маппінгу предметів

Відкрийте `src/utils/equipment/itemEquipmentMapping.ts` і оновіть `ITEM_EQUIPMENT_MAPPING`:

```typescript
export const ITEM_EQUIPMENT_MAPPING: Record<string, number> = {
  ng_helmet_leather: 0,    // Замініть на правильний ID з папки
  ng_armor_leather: 1,     // Замініть на правильний ID
  // ...
};
```

**Як знайти правильні ID:**
1. Запустіть скрипт `list-equipment-files.ps1` або відкрийте папку `public/equipment/front/0-male/`
2. Подивіться на файли (0.png, 1.png, 100.png...)
3. Відкрийте файл у графічному редакторі або переглядачі, щоб побачити, що це за предмет
4. Оновіть маппінг в `itemEquipmentMapping.ts`

### 3. Перевірка роботи

1. Запустіть гру (`npm run dev`)
2. Одягніть предмет, для якого налаштовано маппінг
3. Перевірте, чи відображається екіпірування на моделі

**Якщо не працює:**
- Відкрийте консоль браузера (F12)
- Перевірте, чи немає помилок завантаження зображень
- Перевірте шлях до файлу (має бути `/equipment/front/0-male/0.png` для Human Male)
- Переконайтеся, що файл існує за цим шляхом

## Використання

Система автоматично працює в `CharacterEquipmentFrame.tsx`.

Компонент `CharacterModelWithEquipment`:
- Бере базову модель персонажа
- Накладає зображення екіпірованих предметів поверх неї
- Відображає тільки ті предмети, які екіпіровані

## Порядок накладання (z-index)

1. Базова модель (z-index: 0)
2. Броня (z-index: 1)
3. Штани (z-index: 2)
4. Шлем (z-index: 3)
5. Перчатки (z-index: 4)
6. Ботинки (z-index: 5)
7. Зброя (z-index: 6)
8. Щит (z-index: 7)

## Примітки

- Якщо зображення не знайдено, воно автоматично приховується (onError handler)
- Система підтримує різні кути: `front`, `back`, `top` (за замовчуванням `front`)
- Підтримуються всі раси та статі

