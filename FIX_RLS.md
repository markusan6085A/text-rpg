# üîß –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∏ "Internal Server Error" –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

## üîç –ü—Ä–æ–±–ª–µ–º–∞:

–ü–æ–º–∏–ª–∫–∞ "Internal Server Error" –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É `createCharacter` API.

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è 1: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ Backend

**–ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–µ:** –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –≤ —Ç–µ—Ä–º—ñ–Ω–∞–ª, –¥–µ –∑–∞–ø—É—â–µ–Ω–∏–π backend —Å–µ—Ä–≤–µ—Ä (`cd server && npm run dev`).

–¢–∞–º –º–∞—é—Ç—å –±—É—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –ø–æ–º–∏–ª–∫–∏, —è–∫—ñ –ø–æ–∫–∞–∂—É—Ç—å —Ç–æ—á–Ω—É –ø—Ä–∏—á–∏–Ω—É.

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è 2: RLS (Row Level Security) –≤ Supabase

–Ø–∫—â–æ RLS —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π, –∞–ª–µ –Ω–µ–º–∞—î –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø—É, –∑–∞–ø–∏—Ç–∏ –±—É–¥—É—Ç—å –±–ª–æ–∫—É–≤–∞—Ç–∏—Å—è.

### –í–∞—Ä—ñ–∞–Ω—Ç A: –í–∏–º–∫–Ω—É—Ç–∏ RLS (–¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è)

1. –í—ñ–¥–∫—Ä–∏—Ç–∏ Supabase Dashboard
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Table Editor**
3. –í–∏–±—Ä–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é `Account`
4. –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ **"..."** ‚Üí **"RLS"**
5. –í–∏–º–∫–Ω—É—Ç–∏ RLS (toggle switch)

–ü–æ–≤—Ç–æ—Ä–∏—Ç–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—å:
- `Account`
- `Character`
- `InventoryItem`
- `Kv`

**‚ö†Ô∏è –£–≤–∞–≥–∞:** –í–∏–º–∫–Ω–µ–Ω–Ω—è RLS —Ä–æ–±–∏—Ç—å –¥–∞–Ω—ñ –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –¥–ª—è –≤—Å—ñ—Ö. –î–ª—è production –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ RLS.

### –í–∞—Ä—ñ–∞–Ω—Ç B: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ RLS –ø—Ä–∞–≤–∏–ª–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

–î–ª—è production –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ RLS, —â–æ–± –∑–∞–ø–∏—Ç–∏ –ø—Ä–∞—Ü—é–≤–∞–ª–∏.

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è 3: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ .env —Ñ–∞–π–ª

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ `server/.env` –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

```env
DATABASE_URL="postgresql://postgres:–í–ê–®_–ü–ê–†–û–õ–¨@db.xxxxx.supabase.co:5432/postgres"
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production"
```

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è 4: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Prisma Client

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ Prisma Client –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π:

```bash
cd server
npm run prisma:generate
```

---

## üîç –©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤ –ª–æ–≥–∞—Ö Backend:

1. **–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:**
   - `Can't reach database server`
   - `Connection refused`
   - `Authentication failed`

2. **–ü–æ–º–∏–ª–∫–∞ Prisma:**
   - `Prisma Client is not generated`
   - `Table does not exist`
   - `Permission denied`

3. **–ü–æ–º–∏–ª–∫–∞ JWT:**
   - `JWT_SECRET is missing`
   - `Token verification failed`

---

**–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ —Ä—ñ—à–µ–Ω–Ω—è –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** –í–∏–º–∫–Ω—É—Ç–∏ RLS –¥–ª—è —Ç–∞–±–ª–∏—Ü—å `Account` —Ç–∞ `Character` –≤ Supabase Dashboard.
